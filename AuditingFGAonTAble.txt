

SQL> exec dbms_fga.add_policy('musicstation','mka_object','mka_object_access',statement_types => 'insert,delete,select,update');
 
PL/SQL procedure successfully completed
 
SQL> 
SQL> desc dba_fga_audit_trail;
Name               Type                        Nullable Default Comments                                                                              
------------------ --------------------------- -------- ------- ------------------------------------------------------------------------------------- 
SESSION_ID         NUMBER                                       Session id of the query                                                               
TIMESTAMP          DATE                        Y                Date/Time of the query in the session time zone                                       
DB_USER            VARCHAR2(30)                Y                Database username who executes the query                                              
OS_USER            VARCHAR2(255)               Y                OS username who executes the query                                                    
USERHOST           VARCHAR2(128)               Y                Client host machine name                                                              
CLIENT_ID          VARCHAR2(64)                Y                Client identifier in each Oracle session                                              
ECONTEXT_ID        VARCHAR2(64)                Y                Execution Context Identifier for each action                                          
EXT_NAME           VARCHAR2(4000)              Y                External name                                                                         
OBJECT_SCHEMA      VARCHAR2(30)                Y                Owner of the table or view                                                            
OBJECT_NAME        VARCHAR2(128)               Y                Name of the table or view                                                             
POLICY_NAME        VARCHAR2(30)                Y                Name of Fine Grained Auditing Policy                                                  
SCN                NUMBER                      Y                SCN of the query                                                                      
SQL_TEXT           NVARCHAR2(2000)             Y                SQL text of the query                                                                 
SQL_BIND           NVARCHAR2(2000)             Y                Bind variable data of the query                                                       
COMMENT$TEXT       VARCHAR2(4000)              Y                Comments                                                                              
STATEMENT_TYPE     VARCHAR2(7)                 Y                Statement Type of the query                                                           
EXTENDED_TIMESTAMP TIMESTAMP(6) WITH TIME ZONE Y                Timestamp of the query in the session time zone                                       
PROXY_SESSIONID    NUMBER                      Y                Proxy session serial number, if enterprise user has logged in through proxy mechanism 
GLOBAL_UID         VARCHAR2(32)                Y                Global user identifier for the user, if the user had logged in as enterprise user     
INSTANCE_NUMBER    NUMBER                      Y                Instance number as specified in initialization parameter file 'init.ora'              
OS_PROCESS         VARCHAR2(16)                Y                Operating System process identifier of the Oracle server process                      
TRANSACTIONID      RAW(8)                      Y                Transaction identifier of the transaction in which the object is accessed or modified 
STATEMENTID        NUMBER                      Y                Numeric ID for each statement run (a statement may cause many actions)                
ENTRYID            NUMBER                      Y                Numeric ID for each audit trail entry in the session                                  
 
SQL> select * from dba_fga_audit_trail;
 
SESSION_ID TIMESTAMP   DB_USER                        OS_USER                                                                          USERHOST                                                                         CLIENT_ID                                                        ECONTEXT_ID                                                      EXT_NAME                                                                         OBJECT_SCHEMA                  OBJECT_NAME                                                                      POLICY_NAME                           SCN SQL_TEXT                                                                         SQL_BIND                                                                         COMMENT$TEXT                                                                     STATEMENT_TYPE EXTENDED_TIMESTAMP                                                               PROXY_SESSIONID GLOBAL_UID                       INSTANCE_NUMBER OS_PROCESS       TRANSACTIONID    STATEMENTID    ENTRYID
---------- ----------- ------------------------------ -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- -------------------------------------------------------------------------------- ------------------------------ -------------------------------------------------------------------------------- ------------------------------ ---------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------- -------------------------------------------------------------------------------- --------------- -------------------------------- --------------- ---------------- ---------------- ----------- ----------
    325896 30/06/2008  MUSICSTATION                   mkaul                                                                            OMNIFONE\IS00787                                                                                                                                                                                                                                                                                    MUSICSTATION                   MKA_OBJECT                                                                       MKA_OBJECT_ACCESS               140717061                                                                                                                                                                                                                                                    INSERT         30-JUN-08 15.37.43.419105 +01:00                                                                                                                0 21151            06000000A19D0200          11          1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                                                                                                                                                                                                                               
 
SQL> select * from dba_fga_audit_trail;
 
SESSION_ID TIMESTAMP   DB_USER                        OS_USER                                                                          USERHOST                                                                         CLIENT_ID                                                        ECONTEXT_ID                                                      EXT_NAME                                                                         OBJECT_SCHEMA                  OBJECT_NAME                                                                      POLICY_NAME                           SCN SQL_TEXT                                                                         SQL_BIND                                                                         COMMENT$TEXT                                                                     STATEMENT_TYPE EXTENDED_TIMESTAMP                                                               PROXY_SESSIONID GLOBAL_UID                       INSTANCE_NUMBER OS_PROCESS       TRANSACTIONID    STATEMENTID    ENTRYID
---------- ----------- ------------------------------ -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- -------------------------------------------------------------------------------- ------------------------------ -------------------------------------------------------------------------------- ------------------------------ ---------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------- -------------------------------------------------------------------------------- --------------- -------------------------------- --------------- ---------------- ---------------- ----------- ----------
    325896 30/06/2008  MUSICSTATION                   mkaul                                                                            OMNIFONE\IS00787                                                                                                                                                                                                                                                                                    MUSICSTATION                   MKA_OBJECT                                                                       MKA_OBJECT_ACCESS               140717061                                                                                                                                                                                                                                                    INSERT         30-JUN-08 15.37.43.419105 +01:00                                                                                                                0 21151            06000000A19D0200          11          1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                                                                                                                                                                                                                               
 
SQL> select * from dba_fga_audit_trail;
 
SESSION_ID TIMESTAMP   DB_USER                        OS_USER                                                                          USERHOST                                                                         CLIENT_ID                                                        ECONTEXT_ID                                                      EXT_NAME                                                                         OBJECT_SCHEMA                  OBJECT_NAME                                                                      POLICY_NAME                           SCN SQL_TEXT                                                                         SQL_BIND                                                                         COMMENT$TEXT                                                                     STATEMENT_TYPE EXTENDED_TIMESTAMP                                                               PROXY_SESSIONID GLOBAL_UID                       INSTANCE_NUMBER OS_PROCESS       TRANSACTIONID    STATEMENTID    ENTRYID
---------- ----------- ------------------------------ -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- -------------------------------------------------------------------------------- ------------------------------ -------------------------------------------------------------------------------- ------------------------------ ---------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------- -------------------------------------------------------------------------------- --------------- -------------------------------- --------------- ---------------- ---------------- ----------- ----------
    325896 30/06/2008  MUSICSTATION                   mkaul                                                                            OMNIFONE\IS00787                                                                                                                                                                                                                                                                                    MUSICSTATION                   MKA_OBJECT                                                                       MKA_OBJECT_ACCESS               140717061                                                                                                                                                                                                                                                    INSERT         30-JUN-08 15.37.43.419105 +01:00                                                                                                                0 21151            06000000A19D0200          11          1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                                                                                                                                                                                                                               
 
    325896 30/06/2008  MUSICSTATION                   mkaul                                                                            OMNIFONE\IS00787                                                                                                                                                                                                                                                                                    MUSICSTATION                   MKA_OBJECT                                                                       MKA_OBJECT_ACCESS               140717088                                                                                                                                                                                                                                                    INSERT         30-JUN-08 15.38.50.319206 +01:00                                                                                                                0 21151            070024000B740100          19          2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                                                                                                                                                                                                                               
 
SQL> select * from dba_fga_audit_trail;
 
SESSION_ID TIMESTAMP   DB_USER                        OS_USER                                                                          USERHOST                                                                         CLIENT_ID                                                        ECONTEXT_ID                                                      EXT_NAME                                                                         OBJECT_SCHEMA                  OBJECT_NAME                                                                      POLICY_NAME                           SCN SQL_TEXT                                                                         SQL_BIND                                                                         COMMENT$TEXT                                                                     STATEMENT_TYPE EXTENDED_TIMESTAMP                                                               PROXY_SESSIONID GLOBAL_UID                       INSTANCE_NUMBER OS_PROCESS       TRANSACTIONID    STATEMENTID    ENTRYID
---------- ----------- ------------------------------ -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- -------------------------------------------------------------------------------- ------------------------------ -------------------------------------------------------------------------------- ------------------------------ ---------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------- -------------------------------------------------------------------------------- --------------- -------------------------------- --------------- ---------------- ---------------- ----------- ----------
    325896 30/06/2008  MUSICSTATION                   mkaul                                                                            OMNIFONE\IS00787                                                                                                                                                                                                                                                                                    MUSICSTATION                   MKA_OBJECT                                                                       MKA_OBJECT_ACCESS               140717061                                                                                                                                                                                                                                                    INSERT         30-JUN-08 15.37.43.419105 +01:00                                                                                                                0 21151            06000000A19D0200          11          1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                                                                                                                                                                                                                               
 
    325896 30/06/2008  MUSICSTATION                   mkaul                                                                            OMNIFONE\IS00787                                                                                                                                                                                                                                                                                    MUSICSTATION                   MKA_OBJECT                                                                       MKA_OBJECT_ACCESS               140717088                                                                                                                                                                                                                                                    INSERT         30-JUN-08 15.38.50.319206 +01:00                                                                                                                0 21151            070024000B740100          19          2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                                                                                                                                                                                                                               
 
    325896 30/06/2008  MUSICSTATION                   mkaul                                                                            OMNIFONE\IS00787                                                                                                                                                                                                                                                                                    MUSICSTATION                   MKA_OBJECT                                                                       MKA_OBJECT_ACCESS               140717102                                                                                                                                                                                                                                                    SELECT         30-JUN-08 15.39.28.097030 +01:00                                                                                                                0 21151                                      27          3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     select * from mka_object                                                                                                                                                                                                                                                                                                                                                                                                                                          
 
SQL> select * from dba_fga_audit_trail;
 
SESSION_ID TIMESTAMP   DB_USER                        OS_USER                                                                          USERHOST                                                                         CLIENT_ID                                                        ECONTEXT_ID                                                      EXT_NAME                                                                         OBJECT_SCHEMA                  OBJECT_NAME                                                                      POLICY_NAME                           SCN SQL_TEXT                                                                         SQL_BIND                                                                         COMMENT$TEXT                                                                     STATEMENT_TYPE EXTENDED_TIMESTAMP                                                               PROXY_SESSIONID GLOBAL_UID                       INSTANCE_NUMBER OS_PROCESS       TRANSACTIONID    STATEMENTID    ENTRYID
---------- ----------- ------------------------------ -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- -------------------------------------------------------------------------------- ------------------------------ -------------------------------------------------------------------------------- ------------------------------ ---------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------- -------------------------------------------------------------------------------- --------------- -------------------------------- --------------- ---------------- ---------------- ----------- ----------
    325896 30/06/2008  MUSICSTATION                   mkaul                                                                            OMNIFONE\IS00787                                                                                                                                                                                                                                                                                    MUSICSTATION                   MKA_OBJECT                                                                       MKA_OBJECT_ACCESS               140717061                                                                                                                                                                                                                                                    INSERT         30-JUN-08 15.37.43.419105 +01:00                                                                                                                0 21151            06000000A19D0200          11          1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                                                                                                                                                                                                                               
 
    325896 30/06/2008  MUSICSTATION                   mkaul                                                                            OMNIFONE\IS00787                                                                                                                                                                                                                                                                                    MUSICSTATION                   MKA_OBJECT                                                                       MKA_OBJECT_ACCESS               140717088                                                                                                                                                                                                                                                    INSERT         30-JUN-08 15.38.50.319206 +01:00                                                                                                                0 21151            070024000B740100          19          2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                                                                                                                                                                                                                               
 
    325896 30/06/2008  MUSICSTATION                   mkaul                                                                            OMNIFONE\IS00787                                                                                                                                                                                                                                                                                    MUSICSTATION                   MKA_OBJECT                                                                       MKA_OBJECT_ACCESS               140717102                                                                                                                                                                                                                                                    SELECT         30-JUN-08 15.39.28.097030 +01:00                                                                                                                0 21151                                      27          3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     select * from mka_object                                                                                                                                                                                                                                                                                                                                                                                                                                          
 
    325896 30/06/2008  MUSICSTATION                   mkaul                                                                            OMNIFONE\IS00787                                                                                                                                                                                                                                                                                    MUSICSTATION                   MKA_OBJECT                                                                       MKA_OBJECT_ACCESS               140717124                                                                                                                                                                                                                                                    DELETE         30-JUN-08 15.40.30.234411 +01:00                                                                                                                0 21151            09000A0050850000          31          4
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     delete from mka_object where owner = 'SYS'                                                                                                                                                                                                                                                                                                                                                                                                                        
 
    325896 30/06/2008  MUSICSTATION                   mkaul                                                                            OMNIFONE\IS00787                                                                                                                                                                                                                                                                                    MUSICSTATION                   MKA_OBJECT                                                                       MKA_OBJECT_ACCESS               140717134                                                                                                                                                                                                                                                    DELETE         30-JUN-08 15.40.38.298847 +01:00                                                                                                                0 21151            04002200DA740100          39          5
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     delete from mka_object where owner = 'SYS'                                                                                                                                                                                                                                                                                                                                                                                                                        
 
SQL> select t.extended_timestamp,t.sql_text,t.object_name,t.sql_bind,t.statement_type  from dba_fga_audit_trail t;
 
EXTENDED_TIMESTAMP                                                               SQL_TEXT                                                                         OBJECT_NAME                                                                      SQL_BIND                                                                         STATEMENT_TYPE
-------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- --------------
30-JUN-08 15.37.43.419105 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        INSERT
                                                                                 insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                
 
30-JUN-08 15.38.50.319206 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        INSERT
                                                                                 insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                
 
30-JUN-08 15.39.28.097030 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        SELECT
                                                                                 select * from mka_object                                                                                                                                                                                                                           
 
30-JUN-08 15.40.30.234411 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        DELETE
                                                                                 delete from mka_object where owner = 'SYS'                                                                                                                                                                                                         
 
30-JUN-08 15.40.38.298847 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        DELETE
                                                                                 delete from mka_object where owner = 'SYS'                                                                                                                                                                                                         
 
SQL> select t.extended_timestamp,t.sql_text,t.object_name,t.sql_bind,t.statement_type  from dba_fga_audit_trail t;
 
EXTENDED_TIMESTAMP                                                               SQL_TEXT                                                                         OBJECT_NAME                                                                      SQL_BIND                                                                         STATEMENT_TYPE
-------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- --------------
30-JUN-08 15.37.43.419105 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        INSERT
                                                                                 insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                
 
30-JUN-08 15.38.50.319206 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        INSERT
                                                                                 insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                
 
30-JUN-08 15.39.28.097030 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        SELECT
                                                                                 select * from mka_object                                                                                                                                                                                                                           
 
30-JUN-08 15.40.30.234411 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        DELETE
                                                                                 delete from mka_object where owner = 'SYS'                                                                                                                                                                                                         
 
30-JUN-08 15.40.38.298847 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        DELETE
                                                                                 delete from mka_object where owner = 'SYS'                                                                                                                                                                                                         
 
30-JUN-08 15.44.46.706111 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        INSERT
                                                                                 insert into mka_object select * from all_objects where object_id = 931                                                                                                                                                                             
 
30-JUN-08 15.45.09.663157 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        INSERT
                                                                                 insert into mka_object select * from all_objects where object_id = 931                                                                                                                                                                             
 
 
7 rows selected
 
SQL> select t.extended_timestamp,t.sql_text,t.object_name,t.sql_bind,t.statement_type  from dba_fga_audit_trail t;
 
EXTENDED_TIMESTAMP                                                               SQL_TEXT                                                                         OBJECT_NAME                                                                      SQL_BIND                                                                         STATEMENT_TYPE
-------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- --------------
30-JUN-08 15.37.43.419105 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        INSERT
                                                                                 insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                
 
30-JUN-08 15.38.50.319206 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        INSERT
                                                                                 insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                
 
30-JUN-08 15.39.28.097030 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        SELECT
                                                                                 select * from mka_object                                                                                                                                                                                                                           
 
30-JUN-08 15.40.30.234411 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        DELETE
                                                                                 delete from mka_object where owner = 'SYS'                                                                                                                                                                                                         
 
30-JUN-08 15.40.38.298847 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        DELETE
                                                                                 delete from mka_object where owner = 'SYS'                                                                                                                                                                                                         
 
30-JUN-08 15.44.46.706111 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        INSERT
                                                                                 insert into mka_object select * from all_objects where object_id = 931                                                                                                                                                                             
 
30-JUN-08 15.45.09.663157 +01:00                                                                                                                                  MKA_OBJECT                                                                                                                                                        INSERT
                                                                                 insert into mka_object select * from all_objects where object_id = 931                                                                                                                                                                             
 
 
7 rows selected
 
SQL> select t.extended_timestamp,t.client_id, t.sql_text,t.object_name,t.sql_bind,t.statement_type  from dba_fga_audit_trail t;
 
EXTENDED_TIMESTAMP                                                               CLIENT_ID                                                        SQL_TEXT                                                                         OBJECT_NAME                                                                      SQL_BIND                                                                         STATEMENT_TYPE
-------------------------------------------------------------------------------- ---------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- --------------
30-JUN-08 15.37.43.419105 +01:00                                                                                                                                                                                                   MKA_OBJECT                                                                                                                                                        INSERT
                                                                                                                                                  insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                
 
30-JUN-08 15.38.50.319206 +01:00                                                                                                                                                                                                   MKA_OBJECT                                                                                                                                                        INSERT
                                                                                                                                                  insert into mka_object select * from all_objects where rownum <= 10                                                                                                                                                                                
 
30-JUN-08 15.39.28.097030 +01:00                                                                                                                                                                                                   MKA_OBJECT                                                                                                                                                        SELECT
                                                                                                                                                  select * from mka_object                                                                                                                                                                                                                           
 
30-JUN-08 15.40.30.234411 +01:00                                                                                                                                                                                                   MKA_OBJECT                                                                                                                                                        DELETE
                                                                                                                                                  delete from mka_object where owner = 'SYS'                                                                                                                                                                                                         
 
30-JUN-08 15.40.38.298847 +01:00                                                                                                                                                                                                   MKA_OBJECT                                                                                                                                                        DELETE
                                                                                                                                                  delete from mka_object where owner = 'SYS'                                                                                                                                                                                                         
 
30-JUN-08 15.44.46.706111 +01:00                                                                                                                                                                                                   MKA_OBJECT                                                                                                                                                        INSERT
                                                                                                                                                  insert into mka_object select * from all_objects where object_id = 931                                                                                                                                                                             
 
30-JUN-08 15.45.09.663157 +01:00                                                                                                                                                                                                   MKA_OBJECT                                                                                                                                                        INSERT
                                                                                                                                                  insert into mka_object select * from all_objects where object_id = 931                                                                                                                                                                             
 
 
7 rows selected
 
-- This select will get the duplication in Bind variables from the DBA_FGA_AUDIT_TRAIL table 
select sql_bind, count(*) from dba_fga_audit_trail where object_name = 'CUSTOMER_STORE' group by sql_bind having count(*) > 1;


-- Get the duplicated bind variable's GUID and look again in DBA_FGA_AUDIT_TRAIL table to find out the exact rows 
-- being duplicated!
select * from dba_fga_audit_trail where sql_bind like '%75ade628c0a801220180a552d346521e%';

-- Find out excess triggers causing dramas!
select owner, trigger_name
from dba_triggers
where trigger_type = 'AFTER EVENT';
 